<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN GURU SUPER APP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#1e40af',
                        accent: '#fbbf24',
                        success: '#10b981',
                        danger: '#ef4444',
                        dark: '#0f172a',
                        sidebar: '#0f172a'
                    }
                }
            }
        }
    </script>
    <style>
        * { box-sizing: border-box; }
        
        .sidebar-item {
            @apply flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-white/10 hover:text-white transition-all duration-200 cursor-pointer;
        }
        .sidebar-item.active {
            @apply bg-primary text-white;
        }
        .sidebar-item.premium {
            @apply opacity-60;
        }
        .sidebar-item.premium:hover {
            @apply opacity-100;
        }
        
        .card {
            @apply bg-white rounded-xl shadow-sm border border-gray-100 p-6;
        }
        
        .input-field {
            @apply w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 text-sm;
        }
        
        .btn-primary {
            @apply bg-primary hover:bg-secondary text-white font-semibold py-2.5 px-5 rounded-lg transition-all duration-200 inline-flex items-center gap-2;
        }
        
        .btn-secondary {
            @apply bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2.5 px-5 rounded-lg transition-all duration-200 inline-flex items-center gap-2;
        }
        
        .btn-success {
            @apply bg-success hover:bg-green-600 text-white font-semibold py-2.5 px-5 rounded-lg transition-all duration-200 inline-flex items-center gap-2;
        }
        
        .btn-warning {
            @apply bg-accent hover:bg-yellow-500 text-dark font-semibold py-2.5 px-5 rounded-lg transition-all duration-200 inline-flex items-center gap-2;
        }
        
        .btn-danger {
            @apply bg-danger hover:bg-red-600 text-white font-semibold py-2.5 px-5 rounded-lg transition-all duration-200 inline-flex items-center gap-2;
        }
        
        .section-title {
            @apply text-lg font-bold text-gray-800 mb-4 flex items-center gap-2;
        }
        
        .badge {
            @apply px-2 py-1 rounded-full text-xs font-semibold;
        }
        
        .badge-free {
            @apply bg-gray-100 text-gray-600;
        }
        
        .badge-premium {
            @apply bg-gradient-to-r from-yellow-400 to-orange-500 text-white;
        }
        
        .table-auto {
            @apply w-full text-sm text-left;
        }
        
        .table-auto th {
            @apply bg-gray-50 px-4 py-3 font-semibold text-gray-700 border-b;
        }
        
        .table-auto td {
            @apply px-4 py-3 border-b border-gray-100;
        }
        
        /* RTL Support for Arabic */
        .rtl-text {
            direction: rtl;
            text-align: right;
            font-family: 'Traditional Arabic', 'Scheherazade', serif;
        }
        
        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; }
        }
        
        /* Mobile Sidebar */
        @media (max-width: 1024px) {
            .sidebar-mobile-hidden {
                transform: translateX(-100%);
            }
            .sidebar-mobile-show {
                transform: translateX(0);
            }
        }
        
        /* Document Preview */
        .document-preview {
            @apply bg-white border border-gray-200 rounded-lg shadow-inner;
            min-height: 500px;
        }
        
        .document-page {
            @apply bg-white p-8;
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
        }
        
        .document-page.landscape {
            width: 297mm;
            min-height: 210mm;
        }
        /* RTL Support for Arabic Text */
.rtl-text {
    direction: rtl;
    text-align: right;
    font-family: 'Traditional Arabic', 'Scheherazade New', 'Amiri', 'Noto Naskh Arabic', serif;
    line-height: 2;
}

/* Arabic input styling */
[contenteditable].rtl-text:focus {
    outline: 2px solid #10b981;
    border-radius: 4px;
}

/* Improve table cell editing */
td[contenteditable="true"]:focus {
    background-color: #fef9c3 !important;
    outline: 2px solid #eab308;
}

/* LKPD styles */
.lkpd-box {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
}

/* Emoji support */
.emoji-large {
    font-size: 2rem;
}

/* Print improvements */
@media print {
    .document-page {
        padding: 10mm !important;
    }
    
    [contenteditable="true"] {
        border: none !important;
    }
    
    .bg-yellow-50, .bg-blue-50, .bg-green-50 {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
}
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Mobile Menu Button -->
    <button id="mobileMenuBtn" class="lg:hidden fixed top-4 left-4 z-50 bg-dark text-white p-3 rounded-lg shadow-lg no-print">
        <i class="fas fa-bars text-xl"></i>
    </button>

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="fixed lg:static w-72 h-screen bg-sidebar overflow-y-auto z-40 transition-transform duration-300 lg:translate-x-0 -translate-x-full no-print">
            <!-- Header -->
            <div class="p-5 border-b border-gray-700">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 bg-accent rounded-xl flex items-center justify-center">
                        <i class="fas fa-chalkboard-teacher text-2xl text-dark"></i>
                    </div>
                    <div>
                        <h1 class="text-white font-bold">ADMIN GURU</h1>
                        <p class="text-accent text-sm font-semibold">SUPER APP</p>
                    </div>
                </div>
            </div>

            <!-- User Info -->
            <div class="p-5 border-b border-gray-700">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center">
                        <i class="fas fa-user text-white"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p id="userName" class="text-white font-medium truncate">Loading...</p>
                        <span id="userBadge" class="badge badge-free">FREE</span>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="p-4 space-y-2">
                <!-- Dashboard -->
                <div class="sidebar-item active" data-section="dashboard">
                    <i class="fas fa-home w-5"></i>
                    <span>Dashboard</span>
                </div>

                <!-- Modul B: Profil & Dasar -->
                <p class="text-gray-500 text-xs font-bold uppercase mt-6 mb-2 px-4">Profil & Dasar</p>
                
                <div class="sidebar-item" data-section="profil">
                    <i class="fas fa-user-cog w-5"></i>
                    <span>Profil Saya</span>
                </div>
                
                <div class="sidebar-item" data-section="kalender">
                    <i class="fas fa-calendar-alt w-5"></i>
                    <span>Kalender Pendidikan</span>
                </div>
                
                <div class="sidebar-item" data-section="jadwal">
                    <i class="fas fa-clock w-5"></i>
                    <span>Jadwal Pelajaran</span>
                </div>
                
                <div class="sidebar-item" data-section="siswa">
                    <i class="fas fa-users w-5"></i>
                    <span>Data Siswa</span>
                </div>
                
                <div class="sidebar-item" data-section="cp">
                    <i class="fas fa-book-open w-5"></i>
                    <span>Data CP/TP</span>
                </div>

                <!-- Dokumen (Free) -->
                <p class="text-gray-500 text-xs font-bold uppercase mt-6 mb-2 px-4">Dokumen (FREE)</p>
                
                <div class="sidebar-item" data-section="atp">
                    <i class="fas fa-route w-5"></i>
                    <span>ATP</span>
                </div>
                
                <div class="sidebar-item" data-section="prota">
                    <i class="fas fa-calendar-check w-5"></i>
                    <span>Prota</span>
                </div>
                
                <div class="sidebar-item" data-section="promes">
                    <i class="fas fa-table w-5"></i>
                    <span>Promes</span>
                </div>

                <!-- Dokumen (Premium) -->
                <p class="text-gray-500 text-xs font-bold uppercase mt-6 mb-2 px-4">Dokumen (PREMIUM)</p>
                
                <div class="sidebar-item premium" data-section="modul-ajar" data-premium="true">
                    <i class="fas fa-book w-5"></i>
                    <span>Modul Ajar</span>
                    <i class="fas fa-crown text-accent ml-auto text-xs"></i>
                </div>
                
                <div class="sidebar-item premium" data-section="lkpd" data-premium="true">
                    <i class="fas fa-file-alt w-5"></i>
                    <span>LKPD</span>
                    <i class="fas fa-crown text-accent ml-auto text-xs"></i>
                </div>
                
                <div class="sidebar-item premium" data-section="kktp" data-premium="true">
                    <i class="fas fa-tasks w-5"></i>
                    <span>KKTP</span>
                    <i class="fas fa-crown text-accent ml-auto text-xs"></i>
                </div>
                
                <div class="sidebar-item premium" data-section="jurnal" data-premium="true">
                    <i class="fas fa-journal-whills w-5"></i>
                    <span>Jurnal</span>
                    <i class="fas fa-crown text-accent ml-auto text-xs"></i>
                </div>
                
                <div class="sidebar-item premium" data-section="absensi" data-premium="true">
                    <i class="fas fa-clipboard-check w-5"></i>
                    <span>Absensi</span>
                    <i class="fas fa-crown text-accent ml-auto text-xs"></i>
                </div>
                
                <div class="sidebar-item premium" data-section="nilai" data-premium="true">
                    <i class="fas fa-star w-5"></i>
                    <span>Daftar Nilai</span>
                    <i class="fas fa-crown text-accent ml-auto text-xs"></i>
                </div>

                <!-- Tools -->
                <p class="text-gray-500 text-xs font-bold uppercase mt-6 mb-2 px-4">Tools</p>
                
                <div class="sidebar-item" data-section="ai-assistant">
                    <i class="fas fa-robot w-5"></i>
                    <span>AI Assistant</span>
                </div>
                
                <div class="sidebar-item" data-section="panduan">
                    <i class="fas fa-question-circle w-5"></i>
                    <span>Panduan</span>
                </div>

                <!-- Logout -->
                <div class="mt-6 pt-6 border-t border-gray-700">
                    <div class="sidebar-item text-red-400 hover:text-red-300 hover:bg-red-900/30" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt w-5"></i>
                        <span>Keluar</span>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main id="mainContent" class="flex-1 lg:ml-0 p-4 lg:p-8">
            <!-- Top Bar -->
            <div class="flex flex-wrap items-center justify-between gap-4 mb-8 no-print">
                <div class="ml-12 lg:ml-0">
                    <h2 id="pageTitle" class="text-2xl font-bold text-gray-800">Dashboard</h2>
                    <p id="pageSubtitle" class="text-gray-500">Selamat datang di Admin Guru Super App</p>
                </div>
                <div class="flex items-center gap-3">
                    <select id="selectTahunAjar" class="input-field w-auto">
                        <!-- Populated by JS -->
                    </select>
                    <button onclick="showUpgradeModal()" class="btn-warning" id="btnUpgrade">
                        <i class="fas fa-crown"></i>
                        <span class="hidden sm:inline">Upgrade Premium</span>
                    </button>
                </div>
            </div>

            <!-- Content Sections -->
            <!-- ==================== PREMIUM SECTIONS ==================== -->

<!-- Modul Ajar Section -->
<section id="section-modul-ajar" class="section-content hidden">
    <!-- Locked View -->
    <div class="card text-center py-16" id="modulAjarLocked">
        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Modul Ajar</p>
        <button onclick="showUpgradeModal()" class="btn-warning">
            <i class="fas fa-crown"></i> Upgrade Sekarang
        </button>
    </div>
    
    <!-- Premium Content -->
    <div id="modulAjarContent" class="hidden">
        <div class="card mb-6 no-print">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <h3 class="section-title mb-0"><i class="fas fa-book text-primary"></i> Modul Ajar Kurikulum Merdeka</h3>
                <div class="flex flex-wrap gap-3">
                    <select id="modulMapel" class="input-field w-auto">
                        <option value="">Pilih Mapel</option>
                    </select>
                    <select id="modulKelas" class="input-field w-auto">
                        <option value="">Pilih Kelas</option>
                    </select>
                    <select id="modulSemester" class="input-field w-auto">
                        <option value="Ganjil">Ganjil</option>
                        <option value="Genap">Genap</option>
                    </select>
                    <select id="modulBab" class="input-field w-auto">
                        <option value="">Pilih Bab</option>
                    </select>
                    <button onclick="generateModulAjar()" class="btn-success">
                        <i class="fas fa-sync-alt"></i> Generate
                    </button>
                    <button onclick="printDocument('modul')" class="btn-primary">
                        <i class="fas fa-print"></i> Cetak
                    </button>
                </div>
            </div>
        </div>

        <div class="document-preview overflow-x-auto p-4" id="previewModul">
            <div class="document-page" id="documentModul">
                <div class="text-center font-bold text-sm mb-6" style="text-transform: uppercase;">
                    MODUL AJAR KURIKULUM MERDEKA<br>
                    <span style="font-size:11px; font-weight:normal;">Pendekatan Mindful, Meaningful, & Joyful Learning</span>
                </div>

                <!-- Identitas Modul -->
                <div class="bg-gray-100 p-3 rounded mb-4">
                    <h4 class="font-bold text-sm mb-2">A. IDENTITAS MODUL</h4>
                    <table class="w-full text-sm">
                        <tr><td width="180">Nama Penyusun</td><td>: <span class="val-guru"></span> (<span class="val-sekolah"></span>)</td></tr>
                        <tr><td>Mata Pelajaran</td><td>: <span class="val-mapel"></span></td></tr>
                        <tr><td>Kelas / Fase / Semester</td><td>: <span class="val-kelas"></span> / <span class="val-fase"></span> / <span class="val-semester"></span></td></tr>
                        <tr><td>Topik / Bab Materi</td><td>: <span id="modulTopik" class="text-primary font-semibold"></span></td></tr>
                        <tr><td>Alokasi Waktu</td><td>: <span id="modulJp"></span> JP</td></tr>
                    </table>
                </div>

                <!-- Dimensi Profil -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">B. DIMENSI PROFIL LULUSAN</h4>
                    <div id="modulProfil" class="p-2 text-sm"></div>
                </div>

                <!-- Tujuan Pembelajaran -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">C. TUJUAN PEMBELAJARAN</h4>
                    <div id="modulTP" class="p-2 text-sm"></div>
                </div>

                <!-- Pemahaman Bermakna -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">D. PEMAHAMAN BERMAKNA</h4>
                    <div id="modulPemahaman" class="p-2 text-sm"></div>
                </div>

                <!-- Pertanyaan Pemantik -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">E. PERTANYAAN PEMANTIK</h4>
                    <div id="modulPertanyaan" class="p-2 text-sm"></div>
                </div>

                <!-- Kegiatan Pembelajaran -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">F. KEGIATAN PEMBELAJARAN</h4>
                    <div id="modulKegiatan" class="p-2 text-sm"></div>
                </div>

                <!-- Asesmen -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">G. ASESMEN</h4>
                    <div class="p-2 text-sm">
                        <ul class="list-disc ml-4 space-y-1">
                            <li><strong>Diagnostik:</strong> Tanya jawab pemantik di awal pembelajaran untuk mengetahui pemahaman awal siswa.</li>
                            <li><strong>Formatif:</strong> Observasi keterlibatan siswa, diskusi kelompok, dan pengerjaan LKPD.</li>
                            <li><strong>Sumatif:</strong> Tes tertulis, penugasan proyek, atau unjuk kerja di akhir bab.</li>
                        </ul>
                    </div>
                </div>

                <!-- Refleksi -->
                <div class="mb-4">
                    <h4 class="font-bold text-sm bg-gray-100 p-2 rounded mb-2">H. REFLEKSI GURU DAN PESERTA DIDIK</h4>
                    <div class="p-2 text-sm">
                        <p class="mb-2"><strong>Refleksi Guru:</strong></p>
                        <ul class="list-disc ml-4 space-y-1 mb-3">
                            <li>Apakah seluruh siswa mencapai tujuan pembelajaran?</li>
                            <li>Kesulitan apa yang dialami siswa?</li>
                            <li>Langkah apa yang perlu diperbaiki pada pertemuan berikutnya?</li>
                        </ul>
                        <p class="mb-2"><strong>Refleksi Peserta Didik:</strong></p>
                        <ul class="list-disc ml-4 space-y-1">
                            <li>Apa yang sudah saya pahami dari pembelajaran hari ini?</li>
                            <li>Apa yang masih membingungkan?</li>
                            <li>Bagaimana saya bisa menerapkan materi ini dalam kehidupan?</li>
                        </ul>
                    </div>
                </div>

                <!-- Materi Arab (Conditional) -->
                <div id="modulArabSection" class="mb-4 hidden">
                    <h4 class="font-bold text-sm bg-green-100 p-2 rounded mb-2">
                        <i class="fas fa-mosque mr-2"></i>I. MATERI BAHASA ARAB / AYAT AL-QUR'AN
                    </h4>
                    <div id="modulArab" class="p-4 text-right rtl-text" style="font-size: 24px; line-height: 2; direction: rtl;" contenteditable="true">
                        ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê
                    </div>
                    <p class="text-xs text-gray-500 mt-2">* Klik untuk mengedit teks Arab</p>
                </div>

                <!-- Tanda Tangan -->
                <div class="flex justify-between mt-8 text-sm">
                    <div class="text-center">
                        <p>Mengetahui,</p>
                        <p>Kepala Sekolah</p>
                        <br><br><br>
                        <p class="font-bold underline val-kepsek"></p>
                        <p>NIP. <span class="val-nip-kepsek"></span></p>
                    </div>
                    <div class="text-center">
                        <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                        <p>Guru Mata Pelajaran</p>
                        <br><br><br>
                        <p class="font-bold underline val-guru"></p>
                        <p>NIP. <span class="val-nip-guru"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- LKPD Section -->
<section id="section-lkpd" class="section-content hidden">
    <!-- Locked View -->
    <div class="card text-center py-16" id="lkpdLocked">
        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses LKPD</p>
        <button onclick="showUpgradeModal()" class="btn-warning">
            <i class="fas fa-crown"></i> Upgrade Sekarang
        </button>
    </div>
    
    <!-- Premium Content -->
    <div id="lkpdContent" class="hidden">
        <div class="card mb-6 no-print">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <h3 class="section-title mb-0"><i class="fas fa-file-alt text-primary"></i> Lembar Kerja Peserta Didik (LKPD)</h3>
                <div class="flex flex-wrap gap-3">
                    <select id="lkpdMapel" class="input-field w-auto">
                        <option value="">Pilih Mapel</option>
                    </select>
                    <select id="lkpdKelas" class="input-field w-auto">
                        <option value="">Pilih Kelas</option>
                    </select>
                    <select id="lkpdSemester" class="input-field w-auto">
                        <option value="Ganjil">Ganjil</option>
                        <option value="Genap">Genap</option>
                    </select>
                    <select id="lkpdBab" class="input-field w-auto">
                        <option value="">Pilih Bab</option>
                    </select>
                    <select id="lkpdPertemuan" class="input-field w-auto">
                        <option value="">Pilih Pertemuan</option>
                    </select>
                    <button onclick="generateLKPD()" class="btn-success">
                        <i class="fas fa-sync-alt"></i> Generate
                    </button>
                    <button onclick="printDocument('lkpd')" class="btn-primary">
                        <i class="fas fa-print"></i> Cetak
                    </button>
                </div>
            </div>
        </div>

        <div class="document-preview overflow-x-auto p-4" id="previewLkpd">
            <div class="document-page" id="documentLkpd">
                <div style="border: 3px dashed #2563eb; border-radius: 15px; padding: 25px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);">
                    <!-- Header LKPD -->
                    <div class="text-center mb-6">
                        <h1 class="text-2xl font-bold text-primary mb-2">‚ú® LEMBAR KERJA PESERTA DIDIK ‚ú®</h1>
                        <p class="text-lg val-mapel text-gray-700"></p>
                    </div>

                    <!-- Identitas Siswa -->
                    <div class="grid grid-cols-3 gap-4 mb-6 p-4 bg-white rounded-lg">
                        <div class="border-b-2 border-gray-300 pb-2">
                            <span class="text-sm text-gray-500">Nama / Kelompok:</span>
                        </div>
                        <div class="border-b-2 border-gray-300 pb-2">
                            <span class="text-sm text-gray-500">Kelas:</span> <span class="val-kelas font-semibold"></span>
                        </div>
                        <div class="border-b-2 border-gray-300 pb-2">
                            <span class="text-sm text-gray-500">Nilai:</span>
                        </div>
                    </div>

                    <!-- Tujuan Pembelajaran -->
                    <div class="bg-white rounded-lg p-4 mb-6">
                        <h3 class="font-bold text-primary mb-3">
                            <i class="fas fa-bullseye mr-2"></i>A. Tujuan Pembelajaran Hari Ini
                        </h3>
                        <div id="lkpdTP" class="text-sm bg-blue-50 p-3 rounded border-l-4 border-blue-500"></div>
                    </div>

                    <!-- Petunjuk -->
                    <div class="bg-white rounded-lg p-4 mb-6">
                        <h3 class="font-bold text-primary mb-3">
                            <i class="fas fa-info-circle mr-2"></i>B. Petunjuk Kegiatan
                        </h3>
                        <ol class="list-decimal ml-4 text-sm space-y-2">
                            <li>Berdoa sebelum memulai kegiatan pembelajaran.</li>
                            <li>Baca setiap instruksi dengan teliti.</li>
                            <li>Diskusikan bersama teman kelompokmu jika mengerjakan secara berkelompok.</li>
                            <li>Tulis jawabanmu dengan rapi dan jelas.</li>
                            <li>Bertanyalah kepada guru jika ada hal yang kurang dipahami.</li>
                        </ol>
                    </div>

                    <!-- Materi Arab (Conditional) -->
                    <div id="lkpdArabSection" class="bg-white rounded-lg p-4 mb-6 hidden">
                        <h3 class="font-bold text-green-600 mb-3">
                            <i class="fas fa-quran mr-2"></i>Bacaan / Ayat
                        </h3>
                        <div id="lkpdArab" class="text-center p-4 bg-green-50 rounded rtl-text" style="font-size: 28px; line-height: 2.5; direction: rtl;" contenteditable="true">
                            ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê
                        </div>
                    </div>

                    <!-- Kegiatan -->
                    <div class="bg-white rounded-lg p-4 mb-6">
                        <h3 class="font-bold text-primary mb-3">
                            <i class="fas fa-tasks mr-2"></i>C. Ayo Kerjakan!
                        </h3>
                        <p class="text-sm mb-4">Berdasarkan materi <strong id="lkpdMateri"></strong>, kerjakan tugas berikut:</p>
                        
                        <div class="space-y-6">
                            <div class="border-2 border-gray-200 rounded-lg p-4">
                                <p class="font-semibold mb-3">1. Jelaskan pemahaman utamamu mengenai materi ini dengan bahasamu sendiri!</p>
                                <div class="border-b border-dashed border-gray-300 h-24"></div>
                            </div>
                            
                            <div class="border-2 border-gray-200 rounded-lg p-4">
                                <p class="font-semibold mb-3">2. Berikan contoh penerapan materi ini dalam kehidupan sehari-hari!</p>
                                <div class="border-b border-dashed border-gray-300 h-24"></div>
                            </div>
                            
                            <div class="border-2 border-gray-200 rounded-lg p-4">
                                <p class="font-semibold mb-3">3. Apa kesimpulan atau nilai positif yang bisa kamu ambil dari pembelajaran hari ini?</p>
                                <div class="border-b border-dashed border-gray-300 h-24"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Refleksi -->
                    <div class="bg-yellow-50 rounded-lg p-4 mb-6">
                        <h3 class="font-bold text-yellow-700 mb-3">
                            <i class="fas fa-lightbulb mr-2"></i>D. Refleksi Diri
                        </h3>
                        <div class="grid grid-cols-3 gap-4 text-center text-sm">
                            <div class="p-3 bg-white rounded-lg">
                                <p class="text-2xl mb-2">üòä</p>
                                <p>Saya sudah paham</p>
                            </div>
                            <div class="p-3 bg-white rounded-lg">
                                <p class="text-2xl mb-2">ü§î</p>
                                <p>Saya masih bingung</p>
                            </div>
                            <div class="p-3 bg-white rounded-lg">
                                <p class="text-2xl mb-2">üò¢</p>
                                <p>Saya belum paham</p>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="text-center text-green-600 font-bold text-lg">
                        "Semangat Belajar, Sukses Menanti!" üåü
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- KKTP Section -->
<section id="section-kktp" class="section-content hidden">
    <!-- Locked View -->
    <div class="card text-center py-16" id="kktpLocked">
        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses KKTP</p>
        <button onclick="showUpgradeModal()" class="btn-warning">
            <i class="fas fa-crown"></i> Upgrade Sekarang
        </button>
    </div>
    
    <!-- Premium Content -->
    <div id="kktpContent" class="hidden">
        <div class="card mb-6 no-print">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <h3 class="section-title mb-0"><i class="fas fa-tasks text-primary"></i> Kriteria Ketercapaian Tujuan Pembelajaran</h3>
                <div class="flex flex-wrap gap-3">
                    <select id="kktpMapel" class="input-field w-auto">
                        <option value="">Pilih Mapel</option>
                    </select>
                    <select id="kktpKelas" class="input-field w-auto">
                        <option value="">Pilih Kelas</option>
                    </select>
                    <button onclick="generateKKTP()" class="btn-success">
                        <i class="fas fa-sync-alt"></i> Generate
                    </button>
                    <button onclick="printDocument('kktp')" class="btn-primary">
                        <i class="fas fa-print"></i> Cetak
                    </button>
                </div>
            </div>
        </div>

        <div class="document-preview overflow-x-auto p-4" id="previewKktp">
            <div class="document-page" id="documentKktp">
                <div class="text-center font-bold text-sm mb-6" style="text-transform: uppercase;">
                    KRITERIA KETERCAPAIAN TUJUAN PEMBELAJARAN (KKTP)
                </div>
                
                <table class="w-full text-sm mb-6">
                    <tr><td width="180">Penyusun</td><td>: <span class="val-guru"></span></td></tr>
                    <tr><td>Satuan Pendidikan</td><td>: <span class="val-sekolah"></span></td></tr>
                    <tr><td>Tahun Pelajaran</td><td>: <span class="val-tahun"></span></td></tr>
                    <tr><td>Mata Pelajaran</td><td>: <span class="val-mapel"></span></td></tr>
                    <tr><td>Fase / Kelas</td><td>: <span class="val-fase"></span> / <span class="val-kelas"></span></td></tr>
                </table>

                <table class="w-full border-collapse border border-black text-xs" id="tableKktp">
                    <thead>
                        <tr>
                            <th rowspan="2" class="border border-black p-2 bg-gray-100" width="4%">No</th>
                            <th rowspan="2" class="border border-black p-2 bg-gray-100" width="8%">Smt</th>
                            <th rowspan="2" class="border border-black p-2 bg-gray-100" width="12%">Bab</th>
                            <th rowspan="2" class="border border-black p-2 bg-gray-100" width="40%">Tujuan Pembelajaran (TP)</th>
                            <th colspan="3" class="border border-black p-2 bg-gray-100">Kriteria Penentuan KKTP</th>
                            <th rowspan="2" class="border border-black p-2 bg-blue-100" width="8%">KKTP</th>
                        </tr>
                        <tr>
                            <th class="border border-black p-2 bg-gray-100" width="9%">Kompleksitas</th>
                            <th class="border border-black p-2 bg-gray-100" width="9%">Daya Dukung</th>
                            <th class="border border-black p-2 bg-gray-100" width="9%">Intake Siswa</th>
                        </tr>
                    </thead>
                    <tbody id="bodyKktp">
                        <tr>
                            <td colspan="8" class="border border-black p-4 text-center text-gray-500">
                                Klik "Generate" untuk membuat KKTP
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="mt-4 p-3 bg-blue-50 rounded text-xs">
                    <p class="font-semibold mb-2">Keterangan Nilai Kriteria:</p>
                    <ul class="list-disc ml-4 space-y-1">
                        <li><strong>Kompleksitas:</strong> Tinggi (50-64), Sedang (65-80), Rendah (81-100)</li>
                        <li><strong>Daya Dukung:</strong> Tinggi (81-100), Sedang (65-80), Rendah (50-64)</li>
                        <li><strong>Intake Siswa:</strong> Tinggi (81-100), Sedang (65-80), Rendah (50-64)</li>
                    </ul>
                </div>

                <div class="flex justify-between mt-8 text-sm">
                    <div class="text-center">
                        <p>Mengetahui,</p>
                        <p>Kepala Sekolah</p>
                        <br><br><br>
                        <p class="font-bold underline val-kepsek"></p>
                        <p>NIP. <span class="val-nip-kepsek"></span></p>
                    </div>
                    <div class="text-center">
                        <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                        <p>Guru Mata Pelajaran</p>
                        <br><br><br>
                        <p class="font-bold underline val-guru"></p>
                        <p>NIP. <span class="val-nip-guru"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Jurnal Section -->
<section id="section-jurnal" class="section-content hidden">
    <!-- Locked View -->
    <div class="card text-center py-16" id="jurnalLocked">
        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Jurnal Pembelajaran</p>
        <button onclick="showUpgradeModal()" class="btn-warning">
            <i class="fas fa-crown"></i> Upgrade Sekarang
        </button>
    </div>
    
    <!-- Premium Content -->
    <div id="jurnalContent" class="hidden">
        <div class="card mb-6 no-print">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <h3 class="section-title mb-0"><i class="fas fa-journal-whills text-primary"></i> Jurnal Pembelajaran</h3>
                <div class="flex flex-wrap gap-3">
                    <select id="jurnalMapel" class="input-field w-auto">
                        <option value="">Pilih Mapel</option>
                    </select>
                    <select id="jurnalKelas" class="input-field w-auto">
                        <option value="">Pilih Kelas</option>
                    </select>
                    <select id="jurnalSemester" class="input-field w-auto">
                        <option value="Ganjil">Ganjil</option>
                        <option value="Genap">Genap</option>
                    </select>
                    <button onclick="generateJurnal()" class="btn-success">
                        <i class="fas fa-sync-alt"></i> Generate
                    </button>
                    <button onclick="printDocument('jurnal')" class="btn-primary">
                        <i class="fas fa-print"></i> Cetak
                    </button>
                </div>
            </div>
            
            <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                <p class="text-blue-800 text-sm">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>Info:</strong> Jurnal akan otomatis sinkron dengan data Promes dan Absensi. 
                    TP diambil dari Promes, kehadiran dari Absensi.
                </p>
            </div>
        </div>

        <div class="document-preview overflow-x-auto p-4" id="previewJurnal">
            <div class="document-page landscape" id="documentJurnal" style="width: 100%; max-width: none;">
                <div class="text-center font-bold text-sm mb-4" style="text-transform: uppercase;">
                    JURNAL PEMBELAJARAN
                </div>
                
                <table class="text-sm mb-4">
                    <tr><td width="150">Mata Pelajaran</td><td>: <span class="val-mapel"></span></td></tr>
                    <tr><td>Semester</td><td>: <span class="val-semester"></span></td></tr>
                    <tr><td>Tahun Pelajaran</td><td>: <span class="val-tahun"></span></td></tr>
                </table>

                <table class="w-full border-collapse border border-black text-xs" id="tableJurnal">
                    <thead>
                        <tr>
                            <th class="border border-black p-2 bg-gray-100" width="4%">No</th>
                            <th class="border border-black p-2 bg-gray-100" width="10%">Kelas/Fase</th>
                            <th class="border border-black p-2 bg-gray-100" width="15%">Materi (Elemen/CP)</th>
                            <th class="border border-black p-2 bg-gray-100" width="25%">Tujuan Pembelajaran</th>
                            <th class="border border-black p-2 bg-gray-100" width="10%">Kehadiran</th>
                            <th class="border border-black p-2 bg-gray-100" width="10%">Hari/Tanggal</th>
                            <th class="border border-black p-2 bg-gray-100" width="16%">Hasil Pembelajaran</th>
                            <th class="border border-black p-2 bg-gray-100" width="10%">Keterangan</th>
                        </tr>
                    </thead>
                    <tbody id="bodyJurnal">
                        <tr>
                            <td colspan="8" class="border border-black p-4 text-center text-gray-500">
                                Klik "Generate" untuk membuat Jurnal
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="flex justify-between mt-8 text-sm">
                    <div class="text-center">
                        <p>Mengetahui,</p>
                        <p>Kepala Sekolah</p>
                        <br><br><br>
                        <p class="font-bold underline val-kepsek"></p>
                        <p>NIP. <span class="val-nip-kepsek"></span></p>
                    </div>
                    <div class="text-center">
                        <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                        <p>Guru Mata Pelajaran</p>
                        <br><br><br>
                        <p class="font-bold underline val-guru"></p>
                        <p>NIP. <span class="val-nip-guru"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Absensi Section -->
<section id="section-absensi" class="section-content hidden">
    <!-- Locked View -->
    <div class="card text-center py-16" id="absensiLocked">
        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Absensi</p>
        <button onclick="showUpgradeModal()" class="btn-warning">
            <i class="fas fa-crown"></i> Upgrade Sekarang
        </button>
    </div>
    
    <!-- Premium Content -->
    <div id="absensiContent" class="hidden">
        <div class="card mb-6">
            <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
                <h3 class="section-title mb-0"><i class="fas fa-clipboard-check text-primary"></i> Absensi Kehadiran</h3>
                <div class="flex flex-wrap gap-3">
                    <select id="absensiMapel" class="input-field w-auto">
                        <option value="">Pilih Mapel</option>
                    </select>
                    <select id="absensiKelas" class="input-field w-auto">
                        <option value="">Pilih Kelas</option>
                    </select>
                    <input type="date" id="absensiTanggal" class="input-field w-auto">
                    <button onclick="loadAbsensi()" class="btn-success">
                        <i class="fas fa-search"></i> Tampilkan
                    </button>
                    <button onclick="saveAbsensi()" class="btn-primary">
                        <i class="fas fa-save"></i> Simpan
                    </button>
                </div>
            </div>

            <div class="bg-yellow-50 p-3 rounded-lg mb-4">
                <p class="text-yellow-800 text-sm">
                    <i class="fas fa-lightbulb mr-2"></i>
                    <strong>Tips:</strong> Data absensi akan otomatis masuk ke Jurnal Pembelajaran.
                </p>
            </div>

            <!-- Ringkasan -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-green-100 p-4 rounded-lg text-center">
                    <p class="text-green-800 text-sm">Hadir</p>
                    <p id="absensiHadir" class="text-2xl font-bold text-green-600">0</p>
                </div>
                <div class="bg-yellow-100 p-4 rounded-lg text-center">
                    <p class="text-yellow-800 text-sm">Izin</p>
                    <p id="absensiIzin" class="text-2xl font-bold text-yellow-600">0</p>
                </div>
                <div class="bg-blue-100 p-4 rounded-lg text-center">
                    <p class="text-blue-800 text-sm">Sakit</p>
                    <p id="absensiSakit" class="text-2xl font-bold text-blue-600">0</p>
                </div>
                <div class="bg-red-100 p-4 rounded-lg text-center">
                    <p class="text-red-800 text-sm">Alpha</p>
                    <p id="absensiAlpha" class="text-2xl font-bold text-red-600">0</p>
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="table-auto" id="tableAbsensi">
                    <thead>
                        <tr>
                            <th width="5%">No</th>
                            <th width="15%">NISN</th>
                            <th width="35%">Nama Siswa</th>
                            <th width="5%">L/P</th>
                            <th width="40%">Status Kehadiran</th>
                        </tr>
                    </thead>
                    <tbody id="bodyAbsensi">
                        <tr>
                            <td colspan="5" class="text-center text-gray-500 py-8">
                                Pilih kelas dan tanggal, lalu klik "Tampilkan"
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<!-- Daftar Nilai Section -->
<section id="section-nilai" class="section-content hidden">
    <!-- Locked View -->
    <div class="card text-center py-16" id="nilaiLocked">
        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Daftar Nilai</p>
        <button onclick="showUpgradeModal()" class="btn-warning">
            <i class="fas fa-crown"></i> Upgrade Sekarang
        </button>
    </div>
    
    <!-- Premium Content -->
    <div id="nilaiContent" class="hidden">
        <div class="card mb-6 no-print">
            <div class="flex flex-wrap items-center justify-between gap-4 mb-4">
                <h3 class="section-title mb-0"><i class="fas fa-star text-primary"></i> Daftar Nilai</h3>
                <div class="flex flex-wrap gap-3">
                    <select id="nilaiMapel" class="input-field w-auto">
                        <option value="">Pilih Mapel</option>
                    </select>
                    <select id="nilaiKelas" class="input-field w-auto">
                        <option value="">Pilih Kelas</option>
                    </select>
                    <select id="nilaiSemester" class="input-field w-auto">
                        <option value="Ganjil">Ganjil</option>
                        <option value="Genap">Genap</option>
                    </select>
                    <button onclick="loadNilai()" class="btn-success">
                        <i class="fas fa-search"></i> Tampilkan
                    </button>
                    <button onclick="saveNilai()" class="btn-primary">
                        <i class="fas fa-save"></i> Simpan
                    </button>
                    <button onclick="printDocument('nilai')" class="btn-secondary">
                        <i class="fas fa-print"></i> Cetak
                    </button>
                </div>
            </div>

            <!-- Pengaturan Komponen Nilai -->
            <div class="bg-blue-50 p-4 rounded-lg mb-4">
                <h4 class="font-semibold text-blue-800 mb-3">
                    <i class="fas fa-cog mr-2"></i>Komponen Penilaian
                </h4>
                <div class="flex flex-wrap gap-4" id="komponenNilai">
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="nilaiSum1" checked class="w-4 h-4" onchange="updateNilaiTable()">
                        <span class="text-sm">Sumatif 1</span>
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="nilaiSum2" checked class="w-4 h-4" onchange="updateNilaiTable()">
                        <span class="text-sm">Sumatif 2</span>
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="nilaiSum3" class="w-4 h-4" onchange="updateNilaiTable()">
                        <span class="text-sm">Sumatif 3</span>
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="nilaiAts" checked class="w-4 h-4" onchange="updateNilaiTable()">
                        <span class="text-sm">ATS/UTS</span>
                    </label>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="nilaiAsas" checked class="w-4 h-4" onchange="updateNilaiTable()">
                        <span class="text-sm">ASAS/UAS</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="document-preview overflow-x-auto p-4" id="previewNilai">
            <div class="document-page landscape" id="documentNilai" style="width: 100%; max-width: none;">
                <div class="text-center font-bold text-sm mb-4" style="text-transform: uppercase;">
                    DAFTAR NILAI SISWA
                </div>
                
                <table class="text-sm mb-4">
                    <tr>
                        <td width="150">Mata Pelajaran</td><td>: <span class="val-mapel"></span></td>
                        <td width="100">Kelas</td><td>: <span class="val-kelas"></span></td>
                    </tr>
                    <tr>
                        <td>Semester</td><td>: <span class="val-semester"></span></td>
                        <td>Tahun Pelajaran</td><td>: <span class="val-tahun"></span></td>
                    </tr>
                </table>

                <table class="w-full border-collapse border border-black text-xs" id="tableNilai">
                    <thead id="headNilai">
                        <tr>
                            <th class="border border-black p-2 bg-gray-100" width="4%">No</th>
                            <th class="border border-black p-2 bg-gray-100" width="12%">NISN</th>
                            <th class="border border-black p-2 bg-gray-100" width="25%">Nama Siswa</th>
                            <th class="border border-black p-2 bg-gray-100" width="4%">L/P</th>
                            <th class="border border-black p-2 bg-blue-100" width="8%">Sum 1</th>
                            <th class="border border-black p-2 bg-blue-100" width="8%">Sum 2</th>
                            <th class="border border-black p-2 bg-yellow-100" width="8%">ATS</th>
                            <th class="border border-black p-2 bg-yellow-100" width="8%">ASAS</th>
                            <th class="border border-black p-2 bg-green-100" width="8%">NA</th>
                            <th class="border border-black p-2 bg-green-100" width="8%">Predikat</th>
                            <th class="border border-black p-2 bg-gray-100" width="7%">Ket</th>
                        </tr>
                    </thead>
                    <tbody id="bodyNilai">
                        <tr>
                            <td colspan="11" class="border border-black p-4 text-center text-gray-500">
                                Pilih mapel dan kelas, lalu klik "Tampilkan"
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="mt-4 text-xs">
                    <p><strong>Keterangan Predikat:</strong></p>
                    <p>A = 90-100 (Sangat Baik) | B = 80-89 (Baik) | C = 70-79 (Cukup) | D = &lt;70 (Perlu Bimbingan)</p>
                </div>

                <div class="flex justify-between mt-8 text-sm">
                    <div class="text-center">
                        <p>Mengetahui,</p>
                        <p>Kepala Sekolah</p>
                        <br><br><br>
                        <p class="font-bold underline val-kepsek"></p>
                        <p>NIP. <span class="val-nip-kepsek"></span></p>
                    </div>
                    <div class="text-center">
                        <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                        <p>Guru Mata Pelajaran</p>
                        <br><br><br>
                        <p class="font-bold underline val-guru"></p>
                        <p>NIP. <span class="val-nip-guru"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

                <!-- Profil Section -->
                <section id="section-profil" class="section-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Data Diri -->
                        <div class="card lg:col-span-2">
                            <h3 class="section-title"><i class="fas fa-user text-primary"></i> Data Diri</h3>
                            <form id="formProfil" class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>
                                        <input type="text" id="profilNama" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">NIP</label>
                                        <input type="text" id="profilNip" class="input-field" placeholder="Kosongkan jika tidak ada">
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                        <input type="email" id="profilEmail" class="input-field bg-gray-100" readonly>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">No. HP/WA</label>
                                        <input type="tel" id="profilPhone" class="input-field" placeholder="08xxxxxxxxxx">
                                    </div>
                                </div>

                                <hr class="my-6">

                                <h4 class="font-semibold text-gray-800 mb-4">
                                    <i class="fas fa-school mr-2 text-primary"></i>Data Satuan Pendidikan
                                </h4>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Sekolah</label>
                                        <input type="text" id="profilSekolah" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Jenjang</label>
                                        <select id="profilJenjang" class="input-field" required>
                                            <option value="">Pilih Jenjang</option>
                                            <option value="SD">SD / MI</option>
                                            <option value="SMP">SMP / MTs</option>
                                            <option value="SMA">SMA / MA</option>
                                            <option value="SMK">SMK</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Kota/Kabupaten (untuk Tanda Tangan)</label>
                                        <input type="text" id="profilKota" class="input-field" placeholder="Contoh: Jakarta" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Alamat Sekolah</label>
                                        <input type="text" id="profilAlamat" class="input-field">
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Kepala Sekolah</label>
                                        <input type="text" id="profilKepsek" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">NIP Kepala Sekolah</label>
                                        <input type="text" id="profilNipKepsek" class="input-field">
                                    </div>
                                </div>

                                <button type="submit" class="btn-success mt-6">
                                    <i class="fas fa-save"></i> Simpan Profil
                                </button>
                            </form>
                        </div>

                        <!-- Mata Pelajaran Diampu -->
                        <div class="card">
                            <h3 class="section-title"><i class="fas fa-book text-success"></i> Mata Pelajaran Diampu</h3>
                            <div id="listMapelDiampu" class="space-y-3 mb-4">
                                <!-- Populated by JS -->
                            </div>
                            <button onclick="showAddMapelModal()" class="btn-primary w-full">
                                <i class="fas fa-plus"></i> Tambah Mapel
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Kalender Section -->
                <section id="section-kalender" class="section-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Setting Semester -->
                        <div class="card">
                            <h3 class="section-title"><i class="fas fa-calendar text-primary"></i> Pengaturan Semester</h3>
                            <form id="formKalender" class="space-y-4">
                                <div class="p-4 bg-blue-50 rounded-lg mb-4">
                                    <p class="text-blue-800 text-sm">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        Tahun Ajar: <strong id="kalenderTahunAjar"></strong>
                                    </p>
                                </div>
                                
                                <h4 class="font-semibold text-gray-700">Semester Ganjil</h4>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm text-gray-600 mb-1">Tanggal Mulai</label>
                                        <input type="date" id="ganjilMulai" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-600 mb-1">Tanggal Selesai</label>
                                        <input type="date" id="ganjilSelesai" class="input-field" required>
                                    </div>
                                </div>

                                <h4 class="font-semibold text-gray-700 mt-6">Semester Genap</h4>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm text-gray-600 mb-1">Tanggal Mulai</label>
                                        <input type="date" id="genapMulai" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-600 mb-1">Tanggal Selesai</label>
                                        <input type="date" id="genapSelesai" class="input-field" required>
                                    </div>
                                </div>

                                <!-- Khusus Kelas Akhir -->
                                <div class="p-4 bg-yellow-50 rounded-lg mt-6">
                                    <h4 class="font-semibold text-yellow-800 mb-3">
                                        <i class="fas fa-graduation-cap mr-2"></i>Kelas Akhir (6, 9, 12)
                                    </h4>
                                    <p class="text-yellow-700 text-sm mb-3">
                                        Semester genap kelas akhir biasanya lebih pendek karena ujian/kelulusan.
                                    </p>
                                    <div>
                                        <label class="block text-sm text-gray-600 mb-1">Tanggal Selesai Kelas Akhir</label>
                                        <input type="date" id="genapSelesaiKelasAkhir" class="input-field">
                                    </div>
                                </div>

                                <button type="submit" class="btn-success w-full mt-6">
                                    <i class="fas fa-save"></i> Simpan Kalender
                                </button>
                            </form>
                        </div>

                        <!-- Hari Libur -->
                        <div class="card">
                            <h3 class="section-title"><i class="fas fa-umbrella-beach text-accent"></i> Hari Libur</h3>
                            
                            <!-- Libur Nasional Baku -->
                            <div class="mb-6">
                                <h4 class="font-semibold text-gray-700 mb-3">Libur Nasional (Baku)</h4>
                                <div class="bg-gray-50 rounded-lg p-4 max-h-40 overflow-y-auto">
                                    <ul id="liburBaku" class="text-sm text-gray-600 space-y-1">
                                        <!-- Populated by JS -->
                                    </ul>
                                </div>
                                <p class="text-xs text-gray-500 mt-2">* Tidak dapat diubah</p>
                            </div>

                            <!-- Libur Tidak Baku (Editable) -->
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Libur Tambahan (Dapat Diubah)</h4>
                                <div id="liburTambahan" class="space-y-2 mb-4 max-h-60 overflow-y-auto">
                                    <!-- Populated by JS -->
                                </div>
                                <button onclick="showAddLiburModal()" class="btn-secondary w-full">
                                    <i class="fas fa-plus"></i> Tambah Libur
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Jadwal Section -->
                <section id="section-jadwal" class="section-content hidden">
                    <div class="card mb-6">
                        <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
                            <h3 class="section-title mb-0"><i class="fas fa-clock text-primary"></i> Jadwal Pelajaran</h3>
                            <div class="flex gap-3">
                                <select id="jadwalKelas" class="input-field w-auto">
                                    <option value="">Pilih Kelas</option>
                                </select>
                                <button onclick="showAddJadwalModal()" class="btn-primary">
                                    <i class="fas fa-plus"></i> Tambah Jadwal
                                </button>
                            </div>
                        </div>

                        <!-- Setting Jam Pelajaran -->
                        <div class="bg-blue-50 rounded-lg p-4 mb-6">
                            <h4 class="font-semibold text-blue-800 mb-3">
                                <i class="fas fa-cog mr-2"></i>Pengaturan Jam Pelajaran
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Durasi per JP (menit)</label>
                                    <input type="number" id="durasiJp" class="input-field" value="35">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Jam Mulai</label>
                                    <input type="time" id="jamMulai" class="input-field" value="07:00">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Istirahat (menit)</label>
                                    <input type="number" id="durasiIstirahat" class="input-field" value="15">
                                </div>
                            </div>
                            <button onclick="saveJamPelajaran()" class="btn-success mt-4">
                                <i class="fas fa-save"></i> Simpan Pengaturan
                            </button>
                        </div>

                        <!-- Jadwal Table -->
                        <div class="overflow-x-auto">
                            <table class="table-auto" id="tableJadwal">
                                <thead>
                                    <tr>
                                        <th>Jam Ke</th>
                                        <th>Waktu</th>
                                        <th>Senin</th>
                                        <th>Selasa</th>
                                        <th>Rabu</th>
                                        <th>Kamis</th>
                                        <th>Jumat</th>
                                        <th>Sabtu</th>
                                    </tr>
                                </thead>
                                <tbody id="bodyJadwal">
                                    <tr>
                                        <td colspan="8" class="text-center text-gray-500 py-8">
                                            Pilih kelas untuk melihat jadwal
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Data Siswa Section -->
                <section id="section-siswa" class="section-content hidden">
                    <div class="card">
                        <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
                            <h3 class="section-title mb-0"><i class="fas fa-users text-primary"></i> Data Siswa</h3>
                            <div class="flex gap-3">
                                <select id="siswaKelas" class="input-field w-auto">
                                    <option value="">Semua Kelas</option>
                                </select>
                                <button onclick="showImportSiswaModal()" class="btn-success">
                                    <i class="fas fa-file-import"></i> Import CSV
                                </button>
                                <button onclick="showAddSiswaModal()" class="btn-primary">
                                    <i class="fas fa-plus"></i> Tambah Siswa
                                </button>
                            </div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="table-auto" id="tableSiswa">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>NISN</th>
                                        <th>Nama Siswa</th>
                                        <th>L/P</th>
                                        <th>Kelas</th>
                                        <th>Rombel</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="bodySiswa">
                                    <tr>
                                        <td colspan="7" class="text-center text-gray-500 py-8">
                                            Belum ada data siswa
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- CP/TP Section -->
                <section id="section-cp" class="section-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Upload & Data CP -->
                        <div class="lg:col-span-2">
                            <div class="card mb-6">
                                <h3 class="section-title"><i class="fas fa-upload text-success"></i> Upload Data CP/TP</h3>
                                
                                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                                    <p class="text-yellow-800 text-sm">
                                        <strong>Format CSV yang diperlukan:</strong><br>
                                        Fase;Kelas;Semester;Elemen/Bab;Capaian Pembelajaran;Tujuan Pembelajaran;Dimensi Profil
                                    </p>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Mata Pelajaran</label>
                                        <select id="cpMapel" class="input-field">
                                            <option value="">Pilih Mapel</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Jenjang</label>
                                        <select id="cpJenjang" class="input-field">
                                            <option value="">Pilih Jenjang</option>
                                            <option value="SD">SD / MI</option>
                                            <option value="SMP">SMP / MTs</option>
                                            <option value="SMA">SMA / MA / SMK</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors mb-4" id="dropZoneCP">
                                    <input type="file" id="inputFileCP" accept=".csv" class="hidden">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                                    <p class="text-gray-600 mb-2">Drag & drop file CSV atau</p>
                                    <button onclick="document.getElementById('inputFileCP').click()" class="btn-primary">
                                        <i class="fas fa-folder-open"></i> Pilih File
                                    </button>
                                </div>

                                <div class="text-center">
                                    <p class="text-gray-500 text-sm mb-2">atau gunakan link Google Spreadsheet (CSV)</p>
                                    <div class="flex gap-2">
                                        <input type="url" id="cpCsvUrl" class="input-field" placeholder="https://docs.google.com/spreadsheets/.../export?format=csv">
                                        <button onclick="loadCPFromUrl()" class="btn-secondary">
                                            <i class="fas fa-link"></i> Load
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Preview CP -->
                            <div class="card">
                                <h3 class="section-title"><i class="fas fa-eye text-primary"></i> Preview Data CP/TP</h3>
                                <div class="overflow-x-auto max-h-96">
                                    <table class="table-auto text-xs" id="tableCPPreview">
                                        <thead>
                                            <tr>
                                                <th>Fase</th>
                                                <th>Kelas</th>
                                                <th>Smt</th>
                                                <th>Elemen/Bab</th>
                                                <th>CP</th>
                                                <th>TP</th>
                                                <th>Profil</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodyCPPreview">
                                            <tr>
                                                <td colspan="7" class="text-center text-gray-500 py-8">
                                                    Upload file CSV untuk melihat preview
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Data CP Tersimpan -->
                        <div class="card">
                            <h3 class="section-title"><i class="fas fa-database text-primary"></i> Data CP Tersimpan</h3>
                            <div id="listCPTersimpan" class="space-y-2 max-h-96 overflow-y-auto">
                                <p class="text-gray-500 text-sm text-center py-4">Belum ada data tersimpan</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ATP Section -->
                <section id="section-atp" class="section-content hidden">
                    <div class="card mb-6 no-print">
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <h3 class="section-title mb-0"><i class="fas fa-route text-primary"></i> Alur Tujuan Pembelajaran (ATP)</h3>
                            <div class="flex flex-wrap gap-3">
                                <select id="atpMapel" class="input-field w-auto">
                                    <option value="">Pilih Mapel</option>
                                </select>
                                <select id="atpKelas" class="input-field w-auto">
                                    <option value="">Pilih Kelas</option>
                                </select>
                                <select id="atpSemester" class="input-field w-auto">
                                    <option value="Ganjil">Ganjil</option>
                                    <option value="Genap">Genap</option>
                                </select>
                                <button onclick="generateATP()" class="btn-success">
                                    <i class="fas fa-sync-alt"></i> Generate
                                </button>
                                <button onclick="printDocument('atp')" class="btn-primary">
                                    <i class="fas fa-print"></i> Cetak
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ATP Preview -->
                    <div class="document-preview overflow-x-auto p-4" id="previewATP">
                        <div class="document-page landscape" id="documentATP">
                            <div class="text-center font-bold text-sm mb-4" style="text-transform: uppercase;">
                                ALUR TUJUAN PEMBELAJARAN (ATP)<br>
                                TAHUN PELAJARAN <span class="val-tahun"></span>
                            </div>
                            
                            <table class="w-full text-xs mb-4">
                                <tr>
                                    <td width="150">NAMA SEKOLAH</td>
                                    <td>: <span class="val-sekolah"></span></td>
                                    <td width="100">KELAS</td>
                                    <td>: <span class="val-kelas"></span></td>
                                </tr>
                                <tr>
                                    <td>MATA PELAJARAN</td>
                                    <td>: <span class="val-mapel"></span></td>
                                    <td>SEMESTER</td>
                                    <td>: <span class="val-semester"></span></td>
                                </tr>
                                <tr>
                                    <td>FASE</td>
                                    <td>: <span class="val-fase"></span></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </table>

                            <table class="w-full border-collapse border border-black text-xs" id="tableATP">
                                <thead>
                                    <tr>
                                        <th class="border border-black p-2 bg-gray-100" width="3%">NO</th>
                                        <th class="border border-black p-2 bg-gray-100" width="17%">ELEMEN DAN CAPAIAN PEMBELAJARAN</th>
                                        <th class="border border-black p-2 bg-gray-100" width="12%">TUJUAN PEMBELAJARAN</th>
                                        <th class="border border-black p-2 bg-gray-100" width="22%">ALUR TUJUAN PEMBELAJARAN</th>
                                        <th class="border border-black p-2 bg-gray-100" width="14%">DIMENSI PROFIL LULUSAN</th>
                                        <th class="border border-black p-2 bg-gray-100" width="10%">KOMPETENSI</th>
                                        <th class="border border-black p-2 bg-gray-100" width="10%">LINGKUP MATERI</th>
                                        <th class="border border-black p-2 bg-gray-100" width="6%">WAKTU</th>
                                        <th class="border border-black p-2 bg-gray-100" width="6%">KET.</th>
                                    </tr>
                                </thead>
                                <tbody id="bodyATP">
                                    <tr>
                                        <td colspan="9" class="border border-black p-4 text-center text-gray-500">
                                            Klik "Generate" untuk membuat ATP
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="flex justify-between mt-8 text-xs">
                                <div class="text-center">
                                    <p>Mengetahui,</p>
                                    <p>Kepala Sekolah</p>
                                    <br><br><br>
                                    <p class="font-bold underline val-kepsek"></p>
                                    <p>NIP. <span class="val-nip-kepsek"></span></p>
                                </div>
                                <div class="text-center">
                                    <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                                    <p>Guru Mata Pelajaran</p>
                                    <br><br><br>
                                    <p class="font-bold underline val-guru"></p>
                                    <p>NIP. <span class="val-nip-guru"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Prota Section -->
                <section id="section-prota" class="section-content hidden">
                    <div class="card mb-6 no-print">
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <h3 class="section-title mb-0"><i class="fas fa-calendar-check text-primary"></i> Program Tahunan (Prota)</h3>
                            <div class="flex flex-wrap gap-3">
                                <select id="protaMapel" class="input-field w-auto">
                                    <option value="">Pilih Mapel</option>
                                </select>
                                <select id="protaKelas" class="input-field w-auto">
                                    <option value="">Pilih Kelas</option>
                                </select>
                                <button onclick="generateProta()" class="btn-success">
                                    <i class="fas fa-sync-alt"></i> Generate
                                </button>
                                <button onclick="printDocument('prota')" class="btn-primary">
                                    <i class="fas fa-print"></i> Cetak
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="document-preview overflow-x-auto p-4" id="previewProta">
                        <div class="document-page" id="documentProta">
                            <div class="text-center font-bold text-sm mb-6" style="text-transform: uppercase;">
                                PROGRAM TAHUNAN (PROTA)<br>
                                <span class="val-mapel"></span>
                            </div>
                            
                            <table class="w-full text-sm mb-6">
                                <tr>
                                    <td width="180">Satuan Pendidikan</td>
                                    <td width="10">:</td>
                                    <td><span class="val-sekolah"></span></td>
                                </tr>
                                <tr>
                                    <td>Mata Pelajaran</td>
                                    <td>:</td>
                                    <td><span class="val-mapel"></span></td>
                                </tr>
                                <tr>
                                    <td>Fase / Kelas</td>
                                    <td>:</td>
                                    <td><span class="val-fase"></span> / <span class="val-kelas"></span></td>
                                </tr>
                                <tr>
                                    <td>Tahun Pelajaran</td>
                                    <td>:</td>
                                    <td><span class="val-tahun"></span></td>
                                </tr>
                            </table>

                            <table class="w-full border-collapse border border-black text-sm" id="tableProta">
                                <thead>
                                    <tr>
                                        <th class="border border-black p-2 bg-gray-100" width="10%">Semester</th>
                                        <th class="border border-black p-2 bg-gray-100" width="15%">Bab / Elemen</th>
                                        <th class="border border-black p-2 bg-gray-100" width="65%">Tujuan Pembelajaran</th>
                                        <th class="border border-black p-2 bg-gray-100" width="10%">JP</th>
                                    </tr>
                                </thead>
                                <tbody id="bodyProta">
                                    <tr>
                                        <td colspan="4" class="border border-black p-4 text-center text-gray-500">
                                            Klik "Generate" untuk membuat Prota
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="flex justify-between mt-8 text-sm">
                                <div class="text-center">
                                    <p>Mengetahui,</p>
                                    <p>Kepala Sekolah</p>
                                    <br><br><br>
                                    <p class="font-bold underline val-kepsek"></p>
                                    <p>NIP. <span class="val-nip-kepsek"></span></p>
                                </div>
                                <div class="text-center">
                                    <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                                    <p>Guru Mata Pelajaran</p>
                                    <br><br><br>
                                    <p class="font-bold underline val-guru"></p>
                                    <p>NIP. <span class="val-nip-guru"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Promes Section -->
                <section id="section-promes" class="section-content hidden">
                    <div class="card mb-6 no-print">
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <h3 class="section-title mb-0"><i class="fas fa-table text-primary"></i> Program Semester (Promes)</h3>
                            <div class="flex flex-wrap gap-3">
                                <select id="promesMapel" class="input-field w-auto">
                                    <option value="">Pilih Mapel</option>
                                </select>
                                <select id="promesKelas" class="input-field w-auto">
                                    <option value="">Pilih Kelas</option>
                                </select>
                                <select id="promesSemester" class="input-field w-auto">
                                    <option value="Ganjil">Ganjil</option>
                                    <option value="Genap">Genap</option>
                                </select>
                                <button onclick="generatePromes()" class="btn-success">
                                    <i class="fas fa-sync-alt"></i> Generate
                                </button>
                                <button onclick="printDocument('promes')" class="btn-primary">
                                    <i class="fas fa-print"></i> Cetak
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="document-preview overflow-x-auto p-4" id="previewPromes">
                        <div class="document-page landscape" id="documentPromes" style="width: 100%; max-width: none;">
                            <div class="text-center font-bold text-sm mb-4" style="text-transform: uppercase;">
                                PROGRAM SEMESTER (PROMES)<br>
                                SEMESTER <span class="val-semester"></span>
                            </div>
                            
                            <table class="text-xs mb-4">
                                <tr>
                                    <td width="150">Satuan Pendidikan</td>
                                    <td>: <span class="val-sekolah"></span></td>
                                </tr>
                                <tr>
                                    <td>Mata Pelajaran</td>
                                    <td>: <span class="val-mapel"></span></td>
                                </tr>
                                <tr>
                                    <td>Fase / Kelas</td>
                                    <td>: <span class="val-fase"></span> / <span class="val-kelas"></span></td>
                                </tr>
                                <tr>
                                    <td>Tahun Pelajaran</td>
                                    <td>: <span class="val-tahun"></span></td>
                                </tr>
                            </table>

                            <div class="overflow-x-auto">
                                <table class="w-full border-collapse border border-black text-xs" id="tablePromes">
                                    <thead id="headPromes">
                                        <!-- Generated by JS -->
                                    </thead>
                                    <tbody id="bodyPromes">
                                        <tr>
                                            <td colspan="33" class="border border-black p-4 text-center text-gray-500">
                                                Klik "Generate" untuk membuat Promes
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="flex justify-between mt-8 text-xs">
                                <div class="text-center">
                                    <p>Mengetahui,</p>
                                    <p>Kepala Sekolah</p>
                                    <br><br><br>
                                    <p class="font-bold underline val-kepsek"></p>
                                    <p>NIP. <span class="val-nip-kepsek"></span></p>
                                </div>
                                <div class="text-center">
                                    <p><span class="val-kota"></span>, <span class="val-tanggal"></span></p>
                                    <p>Guru Mata Pelajaran</p>
                                    <br><br><br>
                                    <p class="font-bold underline val-guru"></p>
                                    <p>NIP. <span class="val-nip-guru"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- AI Assistant Section -->
                <section id="section-ai-assistant" class="section-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="card">
                            <h3 class="section-title"><i class="fas fa-robot text-accent"></i> AI Assistant</h3>
                            <p class="text-gray-600 mb-4">
                                Gunakan prompt di bawah ini untuk membantu AI (ChatGPT/Gemini/Claude) mengubah materi mentah menjadi format CSV yang bisa diupload ke sistem.
                            </p>

                            <div class="space-y-4">
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-800 mb-2">
                                        <i class="fas fa-file-csv mr-2 text-green-500"></i>
                                        Prompt untuk Membuat CP-Mapel-Jenjang.csv
                                    </h4>
                                    <div class="bg-white rounded border p-3 text-sm font-mono text-gray-700 max-h-40 overflow-y-auto" id="promptCP">
Buatkan data Capaian Pembelajaran (CP) dan Tujuan Pembelajaran (TP) untuk mata pelajaran [NAMA MAPEL] jenjang [SD/SMP/SMA] dalam format CSV dengan delimiter titik koma (;).

Format kolom: Fase;Kelas;Semester;Elemen/Bab;Capaian Pembelajaran (CP);Tujuan Pembelajaran (TP);Dimensi Profil Lulusan

Ketentuan:
1. Fase sesuai jenjang: SD (Fase A=Kls 1-2, B=Kls 3-4, C=Kls 5-6), SMP (Fase D=Kls 7-9), SMA (Fase E=Kls 10, F=Kls 11-12)
2. Semester: Ganjil atau Genap
3. Dimensi Profil Lulusan pilih dari: Keimanan, Kewargaan, Penalaran Kritis, Kreativitas, Kolaborasi, Kemandirian, Kesehatan, Komunikasi
4. JANGAN gunakan tanda koma dalam teks CP dan TP
5. Setiap bab/elemen bisa memiliki beberapa TP

Contoh output:
Fase A;1;Ganjil;Al-Qur'an Hadis / Bab 1;Peserta didik mengenal huruf hijaiyah...;Peserta didik mampu melafalkan huruf hijaiyah...;Keimanan, Komunikasi
                                    </div>
                                    <button onclick="copyPrompt('promptCP')" class="btn-secondary mt-3">
                                        <i class="fas fa-copy"></i> Salin Prompt
                                    </button>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-800 mb-2">
                                        <i class="fas fa-users mr-2 text-blue-500"></i>
                                        Prompt untuk Data Siswa
                                    </h4>
                                    <div class="bg-white rounded border p-3 text-sm font-mono text-gray-700" id="promptSiswa">
Format CSV data siswa (delimiter koma):
nisn,nama,jenis_kelamin,kelas,rombel

Contoh:
0012345678,Ahmad Fauzi,L,7,A
0012345679,Siti Aisyah,P,7,A
                                    </div>
                                    <button onclick="copyPrompt('promptSiswa')" class="btn-secondary mt-3">
                                        <i class="fas fa-copy"></i> Salin Format
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3 class="section-title"><i class="fas fa-lightbulb text-accent"></i> Tips Penggunaan</h3>
                            <div class="space-y-4 text-sm text-gray-700">
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                        <span class="text-blue-600 font-bold">1</span>
                                    </div>
                                    <p>Salin prompt di atas dan paste ke ChatGPT, Gemini, atau Claude.</p>
                                </div>
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                        <span class="text-blue-600 font-bold">2</span>
                                    </div>
                                    <p>Ganti [NAMA MAPEL] dan [JENJANG] sesuai kebutuhan Anda.</p>
                                </div>
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                        <span class="text-blue-600 font-bold">3</span>
                                    </div>
                                    <p>Copy hasil output AI ke notepad/text editor.</p>
                                </div>
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                        <span class="text-blue-600 font-bold">4</span>
                                    </div>
                                    <p>Save file dengan ekstensi .csv (contoh: cp-pai-sd.csv)</p>
                                </div>
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                        <span class="text-blue-600 font-bold">5</span>
                                    </div>
                                    <p>Upload file tersebut di menu "Data CP/TP".</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Panduan Section -->
                <section id="section-panduan" class="section-content hidden">
                    <div class="card">
                        <h3 class="section-title"><i class="fas fa-book-reader text-primary"></i> Panduan Lengkap Penggunaan Aplikasi</h3>
                        
                        <div class="prose max-w-none">
                            <div class="bg-blue-50 rounded-lg p-6 mb-6">
                                <h4 class="text-lg font-bold text-blue-800 mb-3">üéØ Konsep Single Input - Multi Output</h4>
                                <p class="text-blue-700">
                                    Aplikasi ini dirancang untuk memudahkan guru dalam membuat dokumen administrasi mengajar. 
                                    Cukup dengan memasukkan data dasar (Kalender, Jadwal, CP/TP), sistem akan otomatis 
                                    menghasilkan semua dokumen yang dibutuhkan seperti ATP, Prota, Promes, Modul Ajar, dan lainnya.
                                </p>
                            </div>

                            <div class="space-y-6">
                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-3">üìã Langkah 1: Lengkapi Profil</h4>
                                    <ul class="list-disc list-inside text-gray-700 space-y-2 ml-4">
                                        <li>Buka menu <strong>Profil Saya</strong></li>
                                        <li>Isi data diri (Nama, NIP, No. HP)</li>
                                        <li>Isi data sekolah (Nama Sekolah, Jenjang, Kota, Kepala Sekolah)</li>
                                        <li>Tambahkan mata pelajaran yang diampu beserta jumlah JP per pertemuan</li>
                                    </ul>
                                </div>

                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-3">üìÖ Langkah 2: Atur Kalender Pendidikan</h4>
                                    <ul class="list-disc list-inside text-gray-700 space-y-2 ml-4">
                                        <li>Buka menu <strong>Kalender Pendidikan</strong></li>
                                        <li>Set tanggal mulai dan selesai untuk semester ganjil dan genap</li>
                                        <li>Untuk kelas akhir (6, 9, 12), set tanggal selesai yang berbeda</li>
                                        <li>Tambahkan hari libur khusus jika ada</li>
                                    </ul>
                                </div>

                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-3">üìö Langkah 3: Upload Data CP/TP</h4>
                                    <ul class="list-disc list-inside text-gray-700 space-y-2 ml-4">
                                        <li>Buka menu <strong>Data CP/TP</strong></li>
                                        <li>Pilih mata pelajaran dan jenjang</li>
                                        <li>Upload file CSV sesuai format yang ditentukan</li>
                                        <li>Gunakan <strong>AI Assistant</strong> untuk membantu membuat file CSV</li>
                                    </ul>
                                </div>

                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-3">‚è∞ Langkah 4: Buat Jadwal Pelajaran</h4>
                                    <ul class="list-disc list-inside text-gray-700 space-y-2 ml-4">
                                        <li>Buka menu <strong>Jadwal Pelajaran</strong></li>
                                        <li>Set durasi JP dan jam mulai</li>
                                        <li>Pilih kelas dan tambahkan jadwal mengajar</li>
                                        <li>Sistem akan otomatis validasi agar tidak bentrok</li>
                                    </ul>
                                </div>

                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-3">üìÑ Langkah 5: Generate Dokumen</h4>
                                    <ul class="list-disc list-inside text-gray-700 space-y-2 ml-4">
                                        <li>Buka menu dokumen yang diinginkan (ATP, Prota, Promes, dll)</li>
                                        <li>Pilih mapel, kelas, dan semester</li>
                                        <li>Klik tombol <strong>Generate</strong></li>
                                        <li>Dokumen akan otomatis terisi dan bisa dicetak/disimpan PDF</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="bg-yellow-50 rounded-lg p-6 mt-6">
                                <h4 class="text-lg font-bold text-yellow-800 mb-3">‚≠ê Fitur Premium</h4>
                                <p class="text-yellow-700 mb-3">
                                    Upgrade ke Premium untuk mendapatkan akses penuh ke semua fitur:
                                </p>
                                <ul class="list-disc list-inside text-yellow-700 space-y-1 ml-4">
                                    <li>Modul Ajar dengan dukungan teks Arab (RTL)</li>
                                    <li>LKPD (Lembar Kerja Peserta Didik)</li>
                                    <li>KKTP (Kriteria Ketercapaian Tujuan Pembelajaran)</li>
                                    <li>Jurnal Pembelajaran terintegrasi dengan Absensi</li>
                                    <li>Daftar Nilai dengan berbagai komponen penilaian</li>
                                    <li>Bank Soal</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Premium Sections (Modul Ajar, LKPD, KKTP, Jurnal, Absensi, Nilai) -->
                <!-- These sections would show upgrade prompt for free users -->
                <section id="section-modul-ajar" class="section-content hidden">
                    <div class="card text-center py-16" id="modulAjarLocked">
                        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
                        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Modul Ajar</p>
                        <button onclick="showUpgradeModal()" class="btn-warning">
                            <i class="fas fa-crown"></i> Upgrade Sekarang
                        </button>
                    </div>
                    <div id="modulAjarContent" class="hidden">
                        <!-- Premium content here -->
                    </div>
                </section>

                <!-- Similar locked sections for other premium features -->
                <section id="section-lkpd" class="section-content hidden">
                    <div class="card text-center py-16">
                        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
                        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses LKPD</p>
                        <button onclick="showUpgradeModal()" class="btn-warning">
                            <i class="fas fa-crown"></i> Upgrade Sekarang
                        </button>
                    </div>
                </section>

                <section id="section-kktp" class="section-content hidden">
                    <div class="card text-center py-16">
                        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
                        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses KKTP</p>
                        <button onclick="showUpgradeModal()" class="btn-warning">
                            <i class="fas fa-crown"></i> Upgrade Sekarang
                        </button>
                    </div>
                </section>

                <section id="section-jurnal" class="section-content hidden">
                    <div class="card text-center py-16">
                        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
                        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Jurnal Pembelajaran</p>
                        <button onclick="showUpgradeModal()" class="btn-warning">
                            <i class="fas fa-crown"></i> Upgrade Sekarang
                        </button>
                    </div>
                </section>

                <section id="section-absensi" class="section-content hidden">
                    <div class="card text-center py-16">
                        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
                        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Absensi</p>
                        <button onclick="showUpgradeModal()" class="btn-warning">
                            <i class="fas fa-crown"></i> Upgrade Sekarang
                        </button>
                    </div>
                </section>

                <section id="section-nilai" class="section-content hidden">
                    <div class="card text-center py-16">
                        <i class="fas fa-lock text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Fitur Premium</h3>
                        <p class="text-gray-500 mb-6">Upgrade ke Premium untuk mengakses Daftar Nilai</p>
                        <button onclick="showUpgradeModal()" class="btn-warning">
                            <i class="fas fa-crown"></i> Upgrade Sekarang
                        </button>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Upgrade Modal -->
    <div id="modalUpgrade" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md overflow-hidden">
            <div class="bg-gradient-to-r from-yellow-400 to-orange-500 p-6 text-center">
                <i class="fas fa-crown text-5xl text-white mb-3"></i>
                <h3 class="text-2xl font-bold text-white">Upgrade ke Premium</h3>
            </div>
            <div class="p-6">
                <p class="text-gray-600 mb-4">Dapatkan akses penuh ke semua fitur dengan upgrade ke Premium!</p>
                <ul class="space-y-2 mb-6">
                    <li class="flex items-center gap-2 text-gray-700">
                        <i class="fas fa-check text-green-500"></i> Modul Ajar + LKPD
                    </li>
                    <li class="flex items-center gap-2 text-gray-700">
                        <i class="fas fa-check text-green-500"></i> Jurnal & Absensi Terintegrasi
                    </li>
                    <li class="flex items-center gap-2 text-gray-700">
                        <i class="fas fa-check text-green-500"></i> KKTP & Daftar Nilai
                    </li>
                    <li class="flex items-center gap-2 text-gray-700">
                        <i class="fas fa-check text-green-500"></i> Dukungan Teks Arab (RTL)
                    </li>
                    <li class="flex items-center gap-2 text-gray-700">
                        <i class="fas fa-check text-green-500"></i> Bank Soal
                    </li>
                </ul>
                <a id="linkWhatsappUpgrade" href="#" target="_blank" class="btn-success w-full justify-center mb-3">
                    <i class="fab fa-whatsapp"></i> Hubungi Admin via WhatsApp
                </a>
                <button onclick="closeModal('modalUpgrade')" class="btn-secondary w-full justify-center">
                    Nanti Saja
                </button>
            </div>
        </div>
    </div>

    <!-- Add Mapel Modal -->
    <div id="modalAddMapel" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl w-full max-w-md p-6">
            <h3 class="text-lg font-bold text-gray-800 mb-4">
                <i class="fas fa-book mr-2 text-primary"></i>Tambah Mata Pelajaran
            </h3>
            <form id="formAddMapel" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nama Mata Pelajaran</label>
                    <input type="text" id="mapelNama" class="input-field" placeholder="Contoh: Pendidikan Agama Islam" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Jumlah JP per Pertemuan</label>
                    <input type="number" id="mapelJp" class="input-field" value="2" min="1" max="8" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Pertemuan per Minggu</label>
                    <input type="number" id="mapelPertemuan" class="input-field" value="1" min="1" max="5" required>
                </div>
                <div>
                    <label class="flex items-center gap-2">
                        <input type="checkbox" id="mapelArabic" class="w-4 h-4 text-primary">
                        <span class="text-sm text-gray-700">Butuh dukungan teks Arab (RTL)</span>
                    </label>
                </div>
                <div class="flex gap-3 pt-4">
                    <button type="button" onclick="closeModal('modalAddMapel')" class="btn-secondary flex-1 justify-center">
                        Batal
                    </button>
                    <button type="submit" class="btn-success flex-1 justify-center">
                        <i class="fas fa-plus"></i> Tambah
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 flex flex-col items-center">
            <div class="animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent mb-4"></div>
            <p class="text-gray-700 font-medium" id="loadingText">Memproses...</p>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="hidden fixed bottom-4 right-4 z-50 max-w-sm">
        <div class="bg-white rounded-lg shadow-lg border-l-4 p-4 flex items-center gap-3">
            <i id="toastIcon" class="fas text-xl"></i>
            <p id="toastMessage" class="text-gray-700"></p>
        </div>
    </div>

    <script src="js/firebase-config.js"></script>
    <script src="js/app-core.js"></script>
</body>

</html>
